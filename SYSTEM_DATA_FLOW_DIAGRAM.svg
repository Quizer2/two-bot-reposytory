<?xml version="1.0" encoding="UTF-8"?>
<svg width="800" height="600" xmlns="http://www.w3.org/2000/svg">
  
  <!-- Tytuł -->
  <text x="400" y="30" text-anchor="middle" font-family="Arial" font-size="18" font-weight="bold" fill="#2c3e50">
    CryptoBotDesktop - Diagram Przepływu Danych
  </text>

  <!-- WARSTWA 1: ŹRÓDŁA DANYCH -->
  <text x="50" y="70" font-family="Arial" font-size="14" font-weight="bold" fill="#34495e">
    1. ŹRÓDŁA DANYCH
  </text>
  
  <rect x="50" y="80" width="100" height="50" fill="#e74c3c" stroke="#c0392b" stroke-width="2" rx="5"/>
  <text x="100" y="100" text-anchor="middle" font-family="Arial" font-size="10" font-weight="bold" fill="white">
    Exchange APIs
  </text>
  <text x="100" y="115" text-anchor="middle" font-family="Arial" font-size="8" fill="white">
    Binance, Bybit
  </text>

  <rect x="170" y="80" width="100" height="50" fill="#27ae60" stroke="#229954" stroke-width="2" rx="5"/>
  <text x="220" y="100" text-anchor="middle" font-family="Arial" font-size="10" font-weight="bold" fill="white">
    SQLite DB
  </text>
  <text x="220" y="115" text-anchor="middle" font-family="Arial" font-size="8" fill="white">
    Portfolio, Bots
  </text>

  <rect x="290" y="80" width="100" height="50" fill="#e74c3c" stroke="#c0392b" stroke-width="2" rx="5"/>
  <text x="340" y="100" text-anchor="middle" font-family="Arial" font-size="10" font-weight="bold" fill="white">
    Config Files
  </text>
  <text x="340" y="115" text-anchor="middle" font-family="Arial" font-size="8" fill="white">
    YAML/JSON
  </text>

  <!-- WARSTWA 2: ZARZĄDZANIE DANYMI -->
  <text x="50" y="180" font-family="Arial" font-size="14" font-weight="bold" fill="#34495e">
    2. ZARZĄDZANIE DANYMI
  </text>
  
  <rect x="50" y="190" width="120" height="60" fill="#3498db" stroke="#2980b9" stroke-width="2" rx="5"/>
  <text x="110" y="210" text-anchor="middle" font-family="Arial" font-size="10" font-weight="bold" fill="white">
    DataManager
  </text>
  <text x="110" y="225" text-anchor="middle" font-family="Arial" font-size="8" fill="white">
    Centralne API
  </text>
  <text x="110" y="240" text-anchor="middle" font-family="Arial" font-size="8" fill="white">
    Cache (30s TTL)
  </text>

  <rect x="190" y="190" width="120" height="60" fill="#3498db" stroke="#2980b9" stroke-width="2" rx="5"/>
  <text x="250" y="210" text-anchor="middle" font-family="Arial" font-size="10" font-weight="bold" fill="white">
    ProductionDataManager
  </text>
  <text x="250" y="225" text-anchor="middle" font-family="Arial" font-size="8" fill="white">
    Real-time data
  </text>
  <text x="250" y="240" text-anchor="middle" font-family="Arial" font-size="8" fill="white">
    CCXT integration
  </text>

  <rect x="330" y="190" width="100" height="60" fill="#3498db" stroke="#2980b9" stroke-width="2" rx="5"/>
  <text x="380" y="210" text-anchor="middle" font-family="Arial" font-size="10" font-weight="bold" fill="white">
    DatabaseManager
  </text>
  <text x="380" y="225" text-anchor="middle" font-family="Arial" font-size="8" fill="white">
    CRUD operations
  </text>
  <text x="380" y="240" text-anchor="middle" font-family="Arial" font-size="8" fill="white">
    Transactions
  </text>

  <!-- WARSTWA 3: LOGIKA BIZNESOWA -->
  <text x="50" y="300" font-family="Arial" font-size="14" font-weight="bold" fill="#34495e">
    3. LOGIKA BIZNESOWA
  </text>
  
  <rect x="50" y="310" width="100" height="60" fill="#9b59b6" stroke="#8e44ad" stroke-width="2" rx="5"/>
  <text x="100" y="330" text-anchor="middle" font-family="Arial" font-size="10" font-weight="bold" fill="white">
    BotManager
  </text>
  <text x="100" y="345" text-anchor="middle" font-family="Arial" font-size="8" fill="white">
    Bot lifecycle
  </text>
  <text x="100" y="360" text-anchor="middle" font-family="Arial" font-size="8" fill="white">
    Strategy execution
  </text>

  <rect x="170" y="310" width="120" height="60" fill="#9b59b6" stroke="#8e44ad" stroke-width="2" rx="5"/>
  <text x="230" y="330" text-anchor="middle" font-family="Arial" font-size="10" font-weight="bold" fill="white">
    TradingModeManager
  </text>
  <text x="230" y="345" text-anchor="middle" font-family="Arial" font-size="8" fill="white">
    Demo/Production
  </text>
  <text x="230" y="360" text-anchor="middle" font-family="Arial" font-size="8" fill="white">
    State persistence
  </text>

  <rect x="310" y="310" width="100" height="60" fill="#9b59b6" stroke="#8e44ad" stroke-width="2" rx="5"/>
  <text x="360" y="330" text-anchor="middle" font-family="Arial" font-size="10" font-weight="bold" fill="white">
    RiskManager
  </text>
  <text x="360" y="345" text-anchor="middle" font-family="Arial" font-size="8" fill="white">
    Risk assessment
  </text>
  <text x="360" y="360" text-anchor="middle" font-family="Arial" font-size="8" fill="white">
    Position limits
  </text>

  <!-- WARSTWA 4: INTERFEJS UŻYTKOWNIKA -->
  <text x="50" y="420" font-family="Arial" font-size="14" font-weight="bold" fill="#34495e">
    4. INTERFEJS UŻYTKOWNIKA
  </text>
  
  <rect x="50" y="430" width="80" height="50" fill="#e67e22" stroke="#d35400" stroke-width="2" rx="5"/>
  <text x="90" y="450" text-anchor="middle" font-family="Arial" font-size="10" font-weight="bold" fill="white">
    MainWindow
  </text>
  <text x="90" y="465" text-anchor="middle" font-family="Arial" font-size="8" fill="white">
    Central hub
  </text>

  <rect x="140" y="430" width="80" height="50" fill="#e67e22" stroke="#d35400" stroke-width="2" rx="5"/>
  <text x="180" y="450" text-anchor="middle" font-family="Arial" font-size="10" font-weight="bold" fill="white">
    Portfolio
  </text>
  <text x="180" y="465" text-anchor="middle" font-family="Arial" font-size="8" fill="white">
    Balance view
  </text>

  <rect x="230" y="430" width="80" height="50" fill="#e67e22" stroke="#d35400" stroke-width="2" rx="5"/>
  <text x="270" y="450" text-anchor="middle" font-family="Arial" font-size="10" font-weight="bold" fill="white">
    BotManagement
  </text>
  <text x="270" y="465" text-anchor="middle" font-family="Arial" font-size="8" fill="white">
    Bot control
  </text>

  <rect x="320" y="430" width="80" height="50" fill="#e67e22" stroke="#d35400" stroke-width="2" rx="5"/>
  <text x="360" y="450" text-anchor="middle" font-family="Arial" font-size="10" font-weight="bold" fill="white">
    Logs
  </text>
  <text x="360" y="465" text-anchor="middle" font-family="Arial" font-size="8" fill="white">
    System logs
  </text>

  <rect x="410" y="430" width="80" height="50" fill="#e67e22" stroke="#d35400" stroke-width="2" rx="5"/>
  <text x="450" y="450" text-anchor="middle" font-family="Arial" font-size="10" font-weight="bold" fill="white">
    Analysis
  </text>
  <text x="450" y="465" text-anchor="middle" font-family="Arial" font-size="8" fill="white">
    Charts
  </text>

  <rect x="500" y="430" width="80" height="50" fill="#e67e22" stroke="#d35400" stroke-width="2" rx="5"/>
  <text x="540" y="450" text-anchor="middle" font-family="Arial" font-size="10" font-weight="bold" fill="white">
    Settings
  </text>
  <text x="540" y="465" text-anchor="middle" font-family="Arial" font-size="8" fill="white">
    Configuration
  </text>

  <!-- PRZEPŁYWY DANYCH (proste linie) -->
  <line x1="100" y1="130" x2="110" y2="190" stroke="#34495e" stroke-width="2"/>
  <line x1="220" y1="130" x2="380" y2="190" stroke="#34495e" stroke-width="2"/>
  <line x1="340" y1="130" x2="250" y2="190" stroke="#34495e" stroke-width="2"/>

  <line x1="110" y1="250" x2="100" y2="310" stroke="#34495e" stroke-width="2"/>
  <line x1="250" y1="250" x2="230" y2="310" stroke="#34495e" stroke-width="2"/>
  <line x1="380" y1="250" x2="360" y2="310" stroke="#34495e" stroke-width="2"/>

  <line x1="100" y1="370" x2="90" y2="430" stroke="#34495e" stroke-width="2"/>
  <line x1="230" y1="370" x2="180" y2="430" stroke="#34495e" stroke-width="2"/>
  <line x1="360" y1="370" x2="270" y2="430" stroke="#34495e" stroke-width="2"/>

  <!-- KLUCZOWE INFORMACJE -->
  <text x="500" y="70" font-family="Arial" font-size="12" font-weight="bold" fill="#34495e">
    KLUCZOWE MECHANIZMY:
  </text>
  
  <text x="500" y="90" font-family="Arial" font-size="9" fill="#2c3e50">
    • Inicjalizacja: app/main.py → MainWindow
  </text>
  <text x="500" y="105" font-family="Arial" font-size="9" fill="#2c3e50">
    • Dane rynkowe: APIs → Cache (30s TTL)
  </text>
  <text x="500" y="120" font-family="Arial" font-size="9" fill="#2c3e50">
    • Zarządzanie ryzykiem: RiskManager
  </text>
  <text x="500" y="135" font-family="Arial" font-size="9" fill="#2c3e50">
    • Odświeżanie: Timer → UI update
  </text>
  <text x="500" y="150" font-family="Arial" font-size="9" fill="#2c3e50">
    • Persystencja: Single widget instances
  </text>

  <!-- ROZWIĄZANE PROBLEMY -->
  <text x="500" y="180" font-family="Arial" font-size="12" font-weight="bold" fill="#27ae60">
    ROZWIĄZANE PROBLEMY:
  </text>
  
  <text x="500" y="200" font-family="Arial" font-size="9" fill="#27ae60">
    ✓ Duplikacja widgetów → Pojedyncze instancje
  </text>
  <text x="500" y="215" font-family="Arial" font-size="9" fill="#27ae60">
    ✓ Reset trybu handlowego → Persystencja stanu
  </text>
  <text x="500" y="230" font-family="Arial" font-size="9" fill="#27ae60">
    ✓ Optymalizacja danych → Cache
  </text>
  <text x="500" y="245" font-family="Arial" font-size="9" fill="#27ae60">
    ✓ Stabilność UI → Widget state management
  </text>
  <text x="500" y="260" font-family="Arial" font-size="9" fill="#27ae60">
    ✓ Performance → Async + TTL cache
  </text>

  <!-- ARCHITEKTURA -->
  <text x="500" y="290" font-family="Arial" font-size="12" font-weight="bold" fill="#34495e">
    ARCHITEKTURA:
  </text>
  <text x="500" y="310" font-family="Arial" font-size="9" fill="#2c3e50">
    4-warstwowa architektura z separacją
  </text>
  <text x="500" y="325" font-family="Arial" font-size="9" fill="#2c3e50">
    odpowiedzialności
  </text>
  <text x="500" y="340" font-family="Arial" font-size="9" fill="#2c3e50">
    Centralne zarządzanie danymi
  </text>
  <text x="500" y="355" font-family="Arial" font-size="9" fill="#2c3e50">
    Real-time data z cache'owaniem
  </text>
  <text x="500" y="370" font-family="Arial" font-size="9" fill="#2c3e50">
    Modułowa struktura UI
  </text>

</svg>